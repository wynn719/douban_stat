webpackJsonp([2,0],{0:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var n=a(163),s=o(n),r=a(485),i=o(r),c=a(493),u=o(c),f=a(164),d=o(f),l=a(167),p=o(l);s["default"].use(u["default"]),s["default"].http.options.root="https://api.douban.com",s["default"].use(d["default"]);var h=new d["default"]({history:!1,saveScrollPosition:!0,transitionOnLoad:!0});h.map(p["default"]),h.beforeEach(function(t){var e=t.to,a=t.next;"/book"===e.path&&e.query?h.go("/"):a()}),h.redirect({"*":"/"}),h.start(i["default"],"#app")},165:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(175),s=o(n),r=a(177),i=o(r),c=a(176),u=o(c),f=a(163),d=o(f),l=a(166),p=o(l),h="https://api.douban.com/v2",v=2592e5;e["default"]={fetchBooks:function(t,e,a){var o=(new Date).getTime(),n={},s=this;if(n=p["default"].get(t.userID),n&&(n=JSON.parse(n),n.timeStamp+v>o))return void e(n);var r={count:1};(0,u["default"])(r,t),this.getBook(r).then(function(o){for(var n=[],r=0,c=o.total;r<c;r+=100)n.push(r);var f=n.map(function(e){var a={start:e,count:100};return(0,u["default"])(a,t),d["default"].http.jsonp(h+"/book/user/"+a.userID+"/collections",a).then(function(t){if(200===t.status)return t.data})});i["default"].all(f).then(function(a){for(var n={collections:[],total:0},r=0,i=a.length;r<i;r++)for(var c=a[r].collections,u=0,f=c.length;u<f;u++)n.collections.push(c[u]);n.total=o.total,n=s.formatDataForChart(n,t.userID),e(n)})["catch"](function(t){a(t)})})},getBook:function(t){var e={count:100};(0,u["default"])(e,t);var a=new i["default"](function(t,a){d["default"].http.jsonp(h+"/book/user/"+e.userID+"/collections",e).then(function(e){if(200===e.status){var a=e.data;a.current=a.start+a.count,t(a)}})["catch"](function(t){a(t)})});return a},formatDataForChart:function(t,e){var a=(new Date).getTime(),o=t.collections,n={};return o.forEach(function(t){var e=t.updated.substring(0,7).split("-"),a=e[0],o=Number(e[1]);n[a]||(n[a]={}),n[a].collections||(n[a].collections=[]),n[a].collections.push(t),n[a].books||(n[a].books={}),n[a].books[t.status]||(n[a].books[t.status]=[]),n[a].books[t.status].push(t),n[a].status||(n[a].status={}),n[a].status[t.status]||(n[a].status[t.status]=[]);for(var s=0;s<12;s++)n[a].status[t.status][s]||(n[a].status[t.status][s]=null);if(n[a].status[t.status][o-1]++,"read"===t.status){n[a].rating||(n[a].rating={}),void 0===t.rating&&(t.rating={},t.rating.value="no-rating"),n[a].rating[t.rating.value]||(n[a].rating[t.rating.value]=[]);for(var r=0;r<12;r++)n[a].rating[t.rating.value][r]||(n[a].rating[t.rating.value][r]=null);n[a].rating[t.rating.value][o-1]++}}),n?(n.timeStamp=a,p["default"].add(e,(0,s["default"])(n)),n):null}}},166:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=window.localStorage;e["default"]={get:function(t){var e=a.getItem(t);return e||null},add:function(t,e){var o=this;try{a.setItem(t,e)}catch(n){if(o._isQuotaExceeded(n))return o.clear(),o.setItem(t,e),this}return this},destory:function(t){return a.removeItem(t),this},clear:function(){return a.clear(),this},_isQuotaExceeded:function(t){var e=!1;if(t){if(t.code)switch(t.code){case 22:e=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===t.name&&(e=!0)}t.number===-2147024882&&(e=!0)}return e}}},167:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(490),s=o(n),r=a(489),i=o(r),c=a(491),u=o(c);e["default"]={"":{component:s["default"]},home:{component:s["default"]},"/book":{component:i["default"]},"/unknown":{component:u["default"]}}},168:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(213),s=o(n),r=["legendselectchanged","legendselected","legendunselected","datazoom","datarangeselected","timelinechanged","timelineplaychanged","restore","dataviewchanged","magictypechanged","pieselectchanged","pieselected","pieunselected","mapselectchanged","mapselected","mapunselected"],i=["click","dblclick","mouseover","mouseout","mousedown","mouseup","globalout"];e["default"]={props:["options","theme","initOptions","group"],data:function(){return{chart:null}},computed:{width:{cache:!1,getter:function(){return this.chart.getWidth()}},height:{cache:!1,getter:function(){return this.chart.getHeight()}},isDisposed:{cache:!1,getter:function(){return this.chart.isDisposed()}}},methods:{mergeOptions:function(t){this.chart.setOption(t)},resize:function(){this.chart.resize()},dispatchAction:function(t){this.chart.dispatchAction(t)},showLoading:function(){this.chart.showLoading()},hideLoading:function(){this.chart.hideLoading()},getDataURL:function(){return this.chart.getDataURL()},clear:function(){this.chart.clear()},dispose:function(){this.chart.dispose()}},ready:function(){var t=this,e=s["default"].init(this.$el,this.theme,this.initOptions);e.setOption(this.options),this.$watch("options",function(t){e.setOption(t,!0)},{deep:!0}),e.group=this.group,this.$watch("group",function(t){e.group=t}),r.forEach(function(a){e.on(a,function(e){t.$dispatch(a,e)})}),i.forEach(function(a){e.on(a,function(e){t.$dispatch("chart"+a,e)})}),this.chart=e},connect:function(t){"string"!=typeof t&&(t=t.map(function(t){return t.chart})),s["default"].connect(t)},disconnect:function(t){s["default"].connect(t)},registerMap:function(t,e,a){s["default"].registerMap(t,e,a)},registerTheme:function(t,e){s["default"].registerTheme(t,e)}}},169:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),a(468);var n=a(488),s=o(n),r=a(487),i=o(r);e["default"]={components:{"app-header":s["default"],"app-footer":i["default"]}}},170:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(492),s=o(n);e["default"]={components:{chart:s["default"]},props:{chartData:{type:Object,required:!0,"default":{}}}}},171:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={}},172:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(494),s=a(486),r=o(s),i=a(165),c=o(i),u="",f="https://api.douban.com/v2",d="2016";e["default"]={components:{spinner:n.spinner,chart:r["default"]},created:function(){},ready:function(){var t=this,e=this;this.$refs.spinner.show(),u=this.$route.query.userid,e.setUser(),c["default"].fetchBooks({userID:u},function(a){return(a=a[d])?(e.setStatistics(a),e.setTagsInfo(a),e.setBooksChart(a),e.setBooksRatingsChart(a),void t.$refs.spinner.hide()):void t.$refs.spinner.hide()},function(t){console.log(t)})},data:function(){return{booksTotal:0,user:{},firstRead:{},lastRead:{},readTime:{allReadDay:0},years:[],tags:[],chartData:{statu:{},rating:{}},readYear:""}},methods:{setStatistics:function(t){var e=t.books.read,a=this,o={},n=0,s=e.length,r=e[s-1],i=e[0];o.firstReadDay=r.updated.substring(0,10),o.lastReadDay=i.updated.substring(0,10),n=new Date(o.lastReadDay).getTime()-new Date(o.firstReadDay).getTime(),o.allReadDay=n/864e5,o.averageDay=(o.allReadDay/s).toFixed(2),a.booksTotal=s,a.firstRead=r,a.lastRead=i,a.readTime=o,a.readYear=d},setBooksChart:function(t){var e={title:{text:d+"年度图书阅读统计",left:"center",bottom:25},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["在读","想读","已读"]},grid:{left:"0",width:"100%",containLabel:!0},xAxis:[{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]}],yAxis:[{type:"value"}],series:[{name:"在读",type:"bar",stack:"读书状态",data:t.status.reading},{name:"想读",type:"bar",stack:"读书状态",data:t.status.wish},{name:"已读",type:"bar",stack:"读书状态",data:t.status.read}]};this.chartData.statu=e},setBooksRatingsChart:function(t){var e={title:{text:d+"年度图书评价统计",left:"center",bottom:25},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["未评","一星","二星","三星","四星","五星"]},grid:{left:"0",width:"100%",containLabel:!0},xAxis:[{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]}],yAxis:[{type:"value"}],series:[{name:"未评",type:"bar",stack:"星级评价",data:t.rating["no-rating"]},{name:"一星",type:"bar",stack:"星级评价",data:t.rating[1]},{name:"二星",type:"bar",stack:"星级评价",data:t.rating[2]},{name:"三星",type:"bar",stack:"星级评价",data:t.rating[3]},{name:"四星",type:"bar",stack:"星级评价",data:t.rating[4]},{name:"五星",type:"bar",stack:"星级评价",data:t.rating[5]}]};this.chartData.rating=e},setUser:function(){var t=this;t.$http.jsonp(f+"/user/"+u).then(function(e){if(200===e.status){var a=e.data;if(!a)return!1;t.user=a}},function(e){t.loadFaild()})},setTagsInfo:function(t){var e=[],a=this;t.collections.forEach(function(t){var a=t.tags;a&&a.forEach(function(t){e.indexOf(t)===-1&&e.push(t)})}),a.tags=e},loadFaild:function(){this.$refs.spinner.hide(),this.$router.go("unknown")}}}},173:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={data:function(){return{userurl:""}},ready:function(){var t=this,e=/^https:\/\/www.douban.com\/people\/\d+|\w+\d+|\w+\/$/;this.$watch("userurl",function(a){if(e.test(a)){var o="";a=a.replace(/https:\/\/www.douban.com\/people\//,""),o=a.substr(0,a.length-1),t.$router.go({path:"book",query:{userid:o}})}})}}},174:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={methods:{goBack:function(t){this.$router.go(window.history.back())}}}},468:function(t,e){},469:function(t,e){},470:function(t,e){},471:function(t,e){},472:function(t,e){},473:function(t,e){},474:function(t,e){},475:function(t,e){},476:function(t,e){},477:function(t,e){t.exports=" <div class=echarts></div> "},478:function(t,e){t.exports=" <div class=container> <router-view></router-view> <app-footer></app-footer> </div> "},479:function(t,e){t.exports=" <footer> <p class=copyright>Copyright © 2016 <a href=http://zhengbowei.github.io/about title=关于我>Bowei Zheng.</a> Hosted by <a href=https://github.com/zhengbowei/douban_stat target=_blank title=github rel=nofollow>GitHub</a> and powered by <a href=http://vuejs.org.cn/ title=Vue.js官网 rel=nofollow>Vue.js</a>.</p> </footer> "},480:function(t,e){t.exports=' <div class=content _v-00f2f2e0=""> <p class=title _v-00f2f2e0=""><strong _v-00f2f2e0="">输入你的豆瓣个人主页地址：</strong></p> <input type=text class=userurl placeholder=https://www.douban.com/people/81245114/ v-model=userurl debounce=500 _v-00f2f2e0=""> </div> '},481:function(t,e){t.exports=' <style _v-0cc9fb4e=""> /* 覆盖父级元素的样式 */\n  .container {\n    background-color: #000 !important;\n  }\n  footer * {\n    color: #000 !important;\n  } </style> <div class=content _v-0cc9fb4e=""> <div class=face404 _v-0cc9fb4e=""> <div class="eye-socket left" _v-0cc9fb4e=""> <div class=eye _v-0cc9fb4e=""></div> </div> <div class="eye-socket right" _v-0cc9fb4e=""> <div class=eye _v-0cc9fb4e=""></div> </div> </div> <div class=text404 _v-0cc9fb4e=""> <p class=text _v-0cc9fb4e="">Oh!</p> <p class=text _v-0cc9fb4e="">Someting wrong!</p> <a class=redirect href=javascript:void(0) @click=goBack _v-0cc9fb4e="">Go Back?</a> <a class=redirect v-link="\'home\'" _v-0cc9fb4e="">or Go Home?</a> </div> </div> '},482:function(t,e){t.exports=' <chart :options=chartData _v-169fea5e=""></chart> '},483:function(t,e){t.exports=' <header _v-69263686=""> <a v-link="\'/\'" _v-69263686="">Home</a> <a v-link="\'/book\'" _v-69263686="">book</a> </header> '},484:function(t,e){t.exports=' <div class=content _v-f6ccf7f2=""> <spinner id=spinner-box :size=lg text=读取中... v-ref:spinner="" _v-f6ccf7f2=""></spinner> <h2 _v-f6ccf7f2="">{{ user.name }}的{{ readYear }}年豆瓣读书记录</h2> <div class=read-info _v-f6ccf7f2=""> <p _v-f6ccf7f2="">总阅读量：<strong _v-f6ccf7f2="">{{ booksTotal }}</strong>本</p> <p _v-f6ccf7f2="">总阅读时间：<strong _v-f6ccf7f2="">{{ readTime.allReadDay }}</strong>天</p> <p v-show=readTime.firstReadDay _v-f6ccf7f2="">第一本书：于<strong _v-f6ccf7f2="">{{ readTime.firstReadDay }}</strong>读完《{{ firstRead.book &amp;&amp; firstRead.book.title }}》</p> <p v-show=readTime.lastReadDay _v-f6ccf7f2="">最近阅读：于<strong _v-f6ccf7f2="">{{ readTime.lastReadDay }}</strong>读完《{{ lastRead.book &amp;&amp; lastRead.book.title }}》</p> <p v-show=readTime.averageDay _v-f6ccf7f2="">平均阅读时间：<strong _v-f6ccf7f2="">{{ readTime.averageDay }}</strong>天/本</p> </div> <h3 _v-f6ccf7f2=""># 图表统计</h3>  <chart :chart-data=chartData.statu _v-f6ccf7f2=""></chart> <chart :chart-data=chartData.rating _v-f6ccf7f2=""></chart> <h3 class=tags-title _v-f6ccf7f2=""># 读书标签</h3> <div class=read-tags _v-f6ccf7f2=""> <span class="tag label label-info" v-for="tag in tags" style="display: inline-block" _v-f6ccf7f2="">{{ tag }}</span> <p class=no-tag v-if=!tags.length _v-f6ccf7f2="">Ta今年还没有打任何标签</p> </div> </div> '},485:function(t,e,a){var o,n;a(469),o=a(169),n=a(478),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},486:function(t,e,a){var o,n;a(474),o=a(170),n=a(482),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},487:function(t,e,a){var o,n;a(470),n=a(479),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},488:function(t,e,a){var o,n;a(475),o=a(171),n=a(483),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},489:function(t,e,a){var o,n;a(476),o=a(172),n=a(484),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},490:function(t,e,a){var o,n;a(472),o=a(173),n=a(480),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},491:function(t,e,a){var o,n;a(473),o=a(174),n=a(481),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},492:function(t,e,a){var o,n;a(471),o=a(168),n=a(477),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)}});
//# sourceMappingURL=app.5a35ebd7d21c72b82395.js.map