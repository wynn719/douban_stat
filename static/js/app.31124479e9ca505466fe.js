webpackJsonp([2,0],{0:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var n=a(96),s=o(n),r=a(489),i=o(r),c=a(162),u=o(c),d=a(161),l=o(d),p=a(480),f=o(p);s["default"].use(u["default"]),s["default"].http.options.root="https://api.douban.com",s["default"].use(l["default"]);var h=new l["default"]({history:!1,saveScrollPosition:!0,transitionOnLoad:!0});h.map(f["default"]),h.beforeEach(function(t){var e=t.to,a=t.next;"/book"===e.path&&e.query?h.go("/"):a()}),h.redirect({"*":"/"}),h.start(i["default"],"#app")},164:function(t,e){},165:function(t,e){},166:function(t,e){},167:function(t,e){},168:function(t,e){},169:function(t,e){},170:function(t,e){},171:function(t,e){},172:function(t,e){},173:function(t,e){t.exports=" <div class=echarts></div> "},174:function(t,e){t.exports=" <div class=container> <router-view></router-view> <app-footer></app-footer> </div> "},175:function(t,e){t.exports=" <footer> <p class=copyright>Copyright © 2016 <a href=http://zhengbowei.github.io/about title=关于我>Bowei Zheng.</a> Hosted by <a href=https://github.com/zhengbowei/douban_stat target=_blank title=github rel=nofollow>GitHub</a> and powered by <a href=http://vuejs.org.cn/ title=Vue.js官网 rel=nofollow>Vue.js</a>.</p> </footer> "},176:function(t,e){t.exports=' <style _v-0cf45e79=""> /* 覆盖父级元素的样式 */\n  .container {\n    background-color: #000 !important;\n  }\n  footer * {\n    color: #000 !important;\n  } </style> <div class=content _v-0cf45e79=""> <div class=face404 _v-0cf45e79=""> <div class="eye-socket left" _v-0cf45e79=""> <div class=eye _v-0cf45e79=""></div> </div> <div class="eye-socket right" _v-0cf45e79=""> <div class=eye _v-0cf45e79=""></div> </div> </div> <div class=text404 _v-0cf45e79=""> <p class=text _v-0cf45e79="">Oh!</p> <p class=text _v-0cf45e79="">Something wrong!</p> <a class=redirect href=javascript:void(0) @click=goBack _v-0cf45e79="">Go Back?</a> <a class=redirect v-link="\'home\'" _v-0cf45e79="">or Go Home?</a> </div> </div> '},177:function(t,e){t.exports=' <header _v-1c281c9d=""> <a v-link="\'/\'" _v-1c281c9d="">Home</a> <a v-link="\'/book\'" _v-1c281c9d="">book</a> </header> '},178:function(t,e){t.exports=' <div class=content _v-270c5827=""> <spinner id=spinner-box :size=lg text=读取中... v-ref:spinner="" _v-270c5827=""></spinner> <h2 _v-270c5827="">{{ user.name }}的{{ readYear }}年豆瓣读书记录</h2> <div class=read-info _v-270c5827=""> <p _v-270c5827="">总阅读量：<strong _v-270c5827="">{{ booksTotal }}</strong>本</p> <p _v-270c5827="">总阅读时间：<strong _v-270c5827="">{{ readTime.allReadDay }}</strong>天</p> <p v-show=readTime.firstReadDay _v-270c5827="">第一本书：于<strong _v-270c5827="">{{ readTime.firstReadDay }}</strong>读完《{{ firstRead.book &amp;&amp; firstRead.book.title }}》</p> <p v-show=readTime.lastReadDay _v-270c5827="">最近阅读：于<strong _v-270c5827="">{{ readTime.lastReadDay }}</strong>读完《{{ lastRead.book &amp;&amp; lastRead.book.title }}》</p> <p v-show=readTime.averageDay _v-270c5827="">平均阅读时间：<strong _v-270c5827="">{{ readTime.averageDay }}</strong>天/本</p> </div> <h3 _v-270c5827=""># 图表统计</h3> <chart :chart-data=chartData.statu _v-270c5827=""></chart> <chart :chart-data=chartData.rating _v-270c5827=""></chart> <h3 class=tags-title _v-270c5827=""># 读书标签</h3> <div class=read-tags _v-270c5827=""> <span class="tag label label-info" v-for="tag in tags" style="display: inline-block" _v-270c5827="">{{ tag }}</span> <p class=no-tag v-if=!tags.length _v-270c5827="">Ta今年还没有打任何标签</p> </div> </div> '},179:function(t,e){t.exports=' <chart :options=chartData _v-30a39304=""></chart> '},180:function(t,e){t.exports=' <div class=content _v-3e57ea80=""> <p class=title _v-3e57ea80=""><strong _v-3e57ea80="">输入你的豆瓣个人主页地址：</strong></p> <input type=text class=userurl placeholder=https://www.douban.com/people/81245114/ v-model=userurl debounce=500 value="" _v-3e57ea80=""> </div> '},477:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(474),s=o(n),r=a(476),i=o(r),c=a(475),u=o(c),d=a(96),l=o(d),p=a(479),f=o(p),h="https://api.douban.com/v2",v=2592e5,g={count:100};e["default"]={getBooks:function(t){t=(0,u["default"])({},g,t);var e=new i["default"](function(e,a){l["default"].http.jsonp(h+"/book/user/"+t.userID+"/collections",t).then(function(t){200===t.status&&e(t.data)})["catch"](function(t){a(t)})});return e},fetchBooks:function(t,e,a){var o=(new Date).getTime(),n={},s={},r={},c=this;return n=f["default"].get(t.userID),n&&(n=JSON.parse(n),n.timeStamp+v>o)?void e(n):(r=(0,u["default"])({},g,t),s=(0,u["default"])({},r,{count:1}),void c.getBooks(s).then(function(o){for(var n=[],s=0,d=o.total;s<d;s+=r.count)n.push(s);var p=n.map(function(t){var e=(0,u["default"])({},r,{start:t});return l["default"].http.jsonp(h+"/book/user/"+e.userID+"/collections",e).then(function(t){if(200===t.status)return t.data})});i["default"].all(p).then(function(a){for(var n={collections:[],total:o.total},s=0,r=a.length;s<r;s++)for(var i=a[s].collections,u=0,d=i.length;u<d;u++)n.collections.push(i[u]);n=c.formatDataForChart(n,t.userID),e(n)})["catch"](function(t){a(t)})}))},formatDataForChart:function(t,e){var a=(new Date).getTime(),o=t.collections,n={};return o.forEach(function(t){var e=t.updated.substring(0,7).split("-"),a=Number(e[1]);n.collections=n.collections||[],n.collections.push(t),n.books=n.books||{},n.books[t.status]=n.books[t.status]||[],n.books[t.status].push(t),n.status=n.status||{},n.status[t.status]=n.status[t.status]||[];for(var o=0;o<12;o++)n.status[t.status][o]=n.status[t.status][o]||null;if(n.status[t.status][a-1]++,"read"===t.status){n.rating=n.rating||{},void 0===t.rating&&(t.rating={},t.rating.value="no-rating"),n.rating[t.rating.value]=n.rating[t.rating.value]||[];for(var s=0;s<12;s++)n.rating[t.rating.value][s]=n.rating[t.rating.value][s]||null;n.rating[t.rating.value][a-1]++}}),n?(n.timeStamp=a,f["default"].add(e,(0,s["default"])(n)),n):null}}},478:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={toRfc3339:function(t){return t.replace(" ","T")+"Z"},now:function a(t){var e=new Date,o=function(t){return(t<10?"0":"")+t},a={year:o(e.getFullYear()),mouth:o(e.getMonth()+1),day:o(e.getDate()),hour:o(e.getHours()),minute:o(e.getMinutes()),second:o(e.getSeconds())},n=a.year+"-"+a.mouth+"-"+a.day+" "+a.hour+":"+a.minute+":"+a.second;return t?a.arg:n},getDateTimeByYear:function(t){return t+"-01-01 00:00:00"}}},479:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=window.localStorage;e["default"]={get:function(t){var e=a.getItem(t);return e||null},add:function(t,e){var o=this;try{a.setItem(t,e)}catch(n){if(o._isQuotaExceeded(n))return o.clear(),o.setItem(t,e),this}return this},destory:function(t){return a.removeItem(t),this},clear:function(){return a.clear(),this},_isQuotaExceeded:function(t){var e=!1;if(t){if(t.code)switch(t.code){case 22:e=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===t.name&&(e=!0)}t.number===-2147024882&&(e=!0)}return e}}},480:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(494),s=o(n),r=a(493),i=o(r),c=a(495),u=o(c);e["default"]={"":{component:s["default"]},home:{component:s["default"]},"/book":{component:i["default"]},"/unknown":{component:u["default"]}}},481:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(251),s=o(n),r=["legendselectchanged","legendselected","legendunselected","datazoom","datarangeselected","timelinechanged","timelineplaychanged","restore","dataviewchanged","magictypechanged","pieselectchanged","pieselected","pieunselected","mapselectchanged","mapselected","mapunselected"],i=["click","dblclick","mouseover","mouseout","mousedown","mouseup","globalout"];e["default"]={props:["options","theme","initOptions","group"],data:function(){return{chart:null}},computed:{width:{cache:!1,getter:function(){return this.chart.getWidth()}},height:{cache:!1,getter:function(){return this.chart.getHeight()}},isDisposed:{cache:!1,getter:function(){return this.chart.isDisposed()}}},methods:{mergeOptions:function(t){this.chart.setOption(t)},resize:function(){this.chart.resize()},dispatchAction:function(t){this.chart.dispatchAction(t)},showLoading:function(){this.chart.showLoading()},hideLoading:function(){this.chart.hideLoading()},getDataURL:function(){return this.chart.getDataURL()},clear:function(){this.chart.clear()},dispose:function(){this.chart.dispose()}},ready:function(){var t=this,e=s["default"].init(this.$el,this.theme,this.initOptions);e.setOption(this.options),this.$watch("options",function(t){e.setOption(t,!0)},{deep:!0}),e.group=this.group,this.$watch("group",function(t){e.group=t}),r.forEach(function(a){e.on(a,function(e){t.$dispatch(a,e)})}),i.forEach(function(a){e.on(a,function(e){t.$dispatch("chart"+a,e)})}),this.chart=e},connect:function(t){"string"!=typeof t&&(t=t.map(function(t){return t.chart})),s["default"].connect(t)},disconnect:function(t){s["default"].connect(t)},registerMap:function(t,e,a){s["default"].registerMap(t,e,a)},registerTheme:function(t,e){s["default"].registerTheme(t,e)}}},482:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),a(164);var n=a(492),s=o(n),r=a(491),i=o(r);e["default"]={components:{"app-header":s["default"],"app-footer":i["default"]}}},483:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(488),s=o(n);e["default"]={components:{chart:s["default"]},props:{chartData:{type:Object,required:!0,"default":{}}}}},484:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={}},485:function(t,e,a){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(163),s=a(490),r=o(s),i=a(477),c=o(i),u=a(478),d=o(u),l="",p="https://api.douban.com/v2",f="2016";e["default"]={components:{spinner:n.spinner,chart:r["default"]},created:function(){},ready:function(){var t=this,e=this;this.$refs.spinner.show(),l=this.$route.query.userid,e.setUser(),c["default"].fetchBooks({userID:l,from:d["default"].toRfc3339("2016-01-01 00:00:00"),to:d["default"].toRfc3339(d["default"].now())},function(a){return a?(e.setStatistics(a),e.setTagsInfo(a),e.setBooksChart(a),e.setBooksRatingsChart(a),void t.$refs.spinner.hide()):void t.$refs.spinner.hide()},function(t){console.log(t)})},data:function(){return{booksTotal:0,user:{},firstRead:{},lastRead:{},readTime:{allReadDay:0},years:[],tags:[],chartData:{statu:{},rating:{}},readYear:""}},methods:{setStatistics:function(t){var e=t.books.read,a=this,o={},n=0,s=e.length,r=e[s-1],i=e[0];o.firstReadDay=r.updated.substring(0,10),o.lastReadDay=i.updated.substring(0,10),n=new Date(o.lastReadDay).getTime()-new Date(o.firstReadDay).getTime(),o.allReadDay=n/864e5,o.averageDay=(o.allReadDay/s).toFixed(2),a.booksTotal=s,a.firstRead=r,a.lastRead=i,a.readTime=o,a.readYear=f},setBooksChart:function(t){var e={title:{text:f+"年度图书阅读统计",left:"center",bottom:25},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["在读","想读","已读"]},grid:{left:"0",width:"100%",containLabel:!0},xAxis:[{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]}],yAxis:[{type:"value"}],series:[{name:"在读",type:"bar",stack:"读书状态",data:t.status.reading},{name:"想读",type:"bar",stack:"读书状态",data:t.status.wish},{name:"已读",type:"bar",stack:"读书状态",data:t.status.read}]};this.chartData.statu=e},setBooksRatingsChart:function(t){var e={title:{text:f+"年度图书评价统计",left:"center",bottom:25},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["未评","一星","二星","三星","四星","五星"]},grid:{left:"0",width:"100%",containLabel:!0},xAxis:[{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]}],yAxis:[{type:"value"}],series:[{name:"未评",type:"bar",stack:"星级评价",data:t.rating["no-rating"]},{name:"一星",type:"bar",stack:"星级评价",data:t.rating[1]},{name:"二星",type:"bar",stack:"星级评价",data:t.rating[2]},{name:"三星",type:"bar",stack:"星级评价",data:t.rating[3]},{name:"四星",type:"bar",stack:"星级评价",data:t.rating[4]},{name:"五星",type:"bar",stack:"星级评价",data:t.rating[5]}]};this.chartData.rating=e},setUser:function(){var t=this;t.$http.jsonp(p+"/user/"+l).then(function(e){if(200===e.status){var a=e.data;if(!a)return!1;t.user=a}},function(e){t.loadFaild()})},setTagsInfo:function(t){var e=[],a=this;t.collections.forEach(function(t){var a=t.tags;a&&a.forEach(function(t){e.indexOf(t)===-1&&e.push(t)})}),a.tags=e},loadFaild:function(){this.$refs.spinner.hide(),this.$router.go("unknown")}}}},486:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={data:function(){return{userurl:""}},ready:function(){var t=this,e=/^https:\/\/www.douban.com\/people\/\d+|\w+\d+|\w+\/$/;this.$watch("userurl",function(a){if(e.test(a)){var o="";a=a.replace(/https:\/\/www.douban.com\/people\//,""),o=a.substr(0,a.length-1),t.$router.go({path:"book",query:{userid:o}})}})}}},487:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={methods:{goBack:function(t){this.$router.go(window.history.back())}}}},488:function(t,e,a){var o,n;a(167),o=a(481),n=a(173),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},489:function(t,e,a){var o,n;a(165),o=a(482),n=a(174),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},490:function(t,e,a){var o,n;a(171),o=a(483),n=a(179),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},491:function(t,e,a){var o,n;a(166),n=a(175),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},492:function(t,e,a){var o,n;a(169),o=a(484),n=a(177),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},493:function(t,e,a){var o,n;a(170),o=a(485),n=a(178),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},494:function(t,e,a){var o,n;a(172),o=a(486),n=a(180),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)},495:function(t,e,a){var o,n;a(168),o=a(487),n=a(176),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),n&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=n)}});
//# sourceMappingURL=app.31124479e9ca505466fe.js.map